---
// src/components/Tabs/Tab.astro
export interface Props {
	id: string;
	controls: string;
	selected?: boolean;
	disabled?: boolean;
	icon?: string;
	badge?: string | number;
	class?: string;
}

const { id, controls, selected = false, disabled = false, icon, badge, class: className = "" } = Astro.props;
---

<button type="button" role="tab" id={id} aria-selected={selected} aria-controls={controls} aria-disabled={disabled} tabindex={selected ? 0 : -1} disabled={disabled} class:list={["tabs__tab", selected && "is-active", disabled && "is-disabled", className]}>
	{icon && <span class="tabs__tab-icon" aria-hidden="true" set:html={icon} />}
	<span class="tabs__tab-label">
		<slot />
	</span>
	{
		badge !== undefined && (
			<span class="tabs__tab-badge" aria-label={`${badge} items`}>
				{badge}
			</span>
		)
	}
</button>

<style>
	.tabs__tab {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		gap: 0.5rem;
		padding: var(--tabs-padding-y) var(--tabs-padding-x);
		font-size: var(--tabs-font-size);
		font-family: var(--tabs-font);
		color: var(--tabs-inactive-color);
		background: transparent;
		border: none;
		border-radius: calc(var(--tabs-radius) - 0.125rem);
		cursor: pointer;
		transition: all 150ms ease;
		white-space: nowrap;
		position: relative;
		@supports (corner-shape: squircle) {
			corner-shape: squircle;
		}
	}

	.tabs__tab-label {
		font-size: inherit;
		font-family: inherit;
	}

	@media (hover: hover) and (pointer: fine) {
		.tabs__tab:hover:not(:disabled) {
			background: var(--tabs-hover-bg);
			color: var(--tabs-active-color);
		}
	}

	.tabs__tab:focus-visible {
		outline: 2px solid var(--tabs-focus-ring);
		outline-offset: 2px;
	}

	.tabs__tab.is-active {
		background: var(--tabs-active-bg);
		color: var(--tabs-active-color);
	}

	.tabs__tab.is-disabled {
		opacity: 0.5;
		cursor: not-allowed;
		pointer-events: none;
	}

	/* Иконки в табах */
	.tabs__tab-icon {
		display: flex;
		align-items: center;
		justify-content: center;
		width: 1.25em;
		height: 1.25em;
	}

	.tabs__tab-icon :global(svg) {
		width: 100%;
		height: 100%;
	}

	/* Жетон счетчика в табах */
	.tabs__tab-badge {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		min-width: 1.25rem;
		height: 1.25rem;
		padding: 0 0.375rem;
		font-size: var(--font-size-xs);
		font-weight: 600;
		color: white;
		background: var(--color-brand-xs);
		border-radius: var(--tabs-radius);
	}

	/* Вариант таблетночных табов */
	:global(.tabs--pills) .tabs__tab {
		border-radius: var(--tabs-radius);
		background: var(--tabs-bg);
	}

	:global(.tabs--pills) .tabs__tab.is-active {
		background: var(--tabs-indicator-color);
		color: white;
	}

	/* Вариант табов с подчекриванием как в MaterialDesign */
	:global(.tabs--underline) .tabs__tab {
		border-radius: 0;
		background: transparent;
		margin-bottom: -2px;
		border-bottom: 2px solid transparent;
	}

	@media (hover: hover) and (pointer: fine) {
		:global(.tabs--underline) .tabs__tab:hover:not(:disabled) {
			background: transparent;
			border-bottom-color: var(--tabs-indicator-color);
			color: var(--tabs-indicator-color);
		}
	}

	:global(.tabs--underline) .tabs__tab.is-active {
		background: transparent;
		box-shadow: none;
		border-bottom-color: var(--tabs-indicator-color);
		color: var(--color-content-main);
	}

	/* Вертикальный вариант */
	:global(.tabs--vertical) .tabs__tab {
		width: 100%;
		justify-content: flex-start;
		margin-right: -2px;
		border-radius: var(--tabs-radius);
		@supports (corner-shape: squircle) {
			corner-shape: squircle;
		}
	}

	:global(.tabs--vertical) .tabs__tab.is-active {
		border-right-color: var(--tabs-indicator-color);
		background: var(--tabs-active-bg);
	}
</style>
